extends layout
include test-case/assertion

block content
  div.content-wrapper
    div.content
      h1= data.title + ' (' + data.techId + ')'
      div(class="current-support-container "+data.core_support_string.replace(" ", "-"))
        p= 'Support level: ' + data.core_support_string
      p!= md.render(data.description)

      if data.recommendation
        p= "Recommendation: " + data.recommendation

      if data.tests.length > 0
        h2 Summary of tests
        each test, index in data.tests
          a(href='/tests/' + testIdHelper.makeSafe(test.id))
            h3(id='support-table-'+test.id)= 'Support for ' + test.title
          if (test.assertion)
            p Assertion: #[+assertion(test.assertion)]
          else
            p Assertion:custom test
          table(aria-labelledby='support-table-'+test.id)
            tr
              th AT
              th Browser
              th Support
            each at in ATBrowsers.core_at
              each browser in ATBrowsers.at[at].core_browsers
                tr
                  td= ATBrowsers.at[at].title
                    if test.at[at].browsers[browser].at_version
                        span= ' ' + test.at[at].browsers[browser].at_version
                  td= ATBrowsers.browsers[browser].title
                    if (test.at[at].browsers[browser].browser_version)
                        span= ' ' + test.at[at].browsers[browser].browser_version
                  td(class='support-case '+test.at[at].browsers[browser].support)= test.at[at].browsers[browser].support_string
      else
        p Sorry, this feature does not have any tests. Please feel free to propose one on GitHub.
    if data.references
      div.sidebar
        if data.related_issues && data.related_issues.length
          h2 Related AT or browser issues
          ul
            each link in data.related_issues
              li
                a(href=link.url) #{link.title}

        h2 Is something not right?
        p We use our #[a(href="https://github.com/accessibilitysupported/accessibilitysupported") GitHub repository] to manage our issue tracking. Please provide as much information as you can for issues, and please leave the id in the issue title intact.
        a(href="https://github.com/accessibilitysupported/accessibilitysupported/issues/new?title="+data.id+"&labels=tech%20feature") Create an issue for this feature

        h2 References
        ul
          each reference in data.references
            li
              a(href=reference.url) #{reference.title}
